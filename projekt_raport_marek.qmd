---
title: "Projekt z Baz Danych – Raport Końcowy"
format:
  html:
    toc: true
    number-sections: true
    code-fold: true
    code-summary: "Rozwiń kod"
    theme:
      light: flatly
      dark: darkly
page-layout: full
---

# Autorzy

- Jakub Ciągło  
- Mateusz Ćwiek  
- Marek Dworaczyk  
- Rafał Głodek

# Importy
```{python}
import random
import math
from datetime import date, datetime, timedelta, time
import numpy as np
import pandas as pd
import mysql.connector
```

```{python}

con = mysql.connector.connect(
    host = "giniewicz.it",
    user = "team13",
    password = "te@mlie",
    port=3306,
    use_pure=True,
    database = "team13"
)
```

# Analiza danych

Pytanie: po których wycieczkach klienci wracają na kolejne, a po których mają dość i więcej ich nie widzicie. Czy są takie, które być może powinny zniknąć z oferty?

Jak do tego problemu podejść? Na początek znajdźmy ludzi którzy byli na więcej niż jednej wycieczce

```{python}
query = "SELECT client_id, COUNT(trip_id) as trips FROM  trip_participants GROUP BY client_id"

cursor = con.cursor()

cursor.execute(query)

trips_of_participant = cursor.fetchall()

for wiersz in trips_of_participant:
    print(wiersz)

```

Super, teraz mamy id uczestnika i na ilu wycieczkach on był. Jako pierwsze możemy sprawdzić wszystkich tych, którzy byli tylko jeden raz. 

```{python}
for wiersz in trips_of_participant:
  if wiersz[1] == 1:
```

##